---
title: 量化基础
date: 2023-01-08 13:05:25
tags:
---
# 量化投资
## 量化投资定义
量化投资是指通过数量化模型建立科学投资体系，以获取稳定收益。
## 量化投资优势
量化投资的优势在于纪律性、系统性、及时性和分散化。
* 纪律性：严格执行投资策略，不随投资者情侣的变化而随意更改，这样可以克服人性的弱点，也可以克服认知偏差。
* 系统性：量化投资的系统性特征包括多层次的量化模型、多角度的观察及海量数据的观察。多层次模型包括大类资产配置模型、行业选择模型、精选个股模型等。多角度观察主要包括对宏观周期、市场结构、估值、成长、盈利质量、市场情绪等多个角度分析。此外，海量数据处理能力能够更好地在广大资本市场捕捉到更多的投资机会，拓展更大的投资机会。
* 及时性：及时快速地跟踪市场变化，不断发现能够提供超额收益的新的统计模型，寻找新的交易机会。
* 准确性：准确客观评价交易机会，克服主观情绪偏差从而盈利。
* 分散化：在控制风险的条件下，量化投资可以充当分散化投资的工具。表现为两个方面：一是量化投资不断地从历史中挖掘有望在未来重复的历史规律并且加以利用，这些历史规律都是较大概率取胜的策略；二是依靠筛选出股票组合来取胜，而不是一只或几只股票取胜。
## 量化策略
使用量化策略是进行量化投资的有效方式，通过客观准确的交易规则构建策略，并在历史数据上进行回测，当回测结果通过评估审核后才可以称得上是一个可进行实盘交易得量化策略，许多私募在实盘前还有一个模拟交易阶段。
## AI量化投资策略构建流程
* 第一步：确定数据（如股票池），划分训练集、测试集；
* 第二步：明确目标，进行数据标注；
    * 目标：人为定义的模型预测目标，例如未来N日收益率、未来N日波动率、未来N日的收益率排序等统计量；
    * 标注：计算训练集数据所在时间阶段的每日目标值。
* 第三步：找因子；构建可能影响目标的特征（量化策略中可称为因子）
    * 特征：反映事物在某方面的表现或性质的事项，在AI量化策略中，特征可以是换手率、市盈率、KDJ技术指标等；
* 第四步：数据连接+缺失数据处理；将上述每只股票的标注数据与特征数据注意链接，以便模型的学习和使用；
* 第五步：模型训练+股票预测
* 第六步：回测；将验证集的预测结果放入历史真实数据中检测。
## 量化结果分析
当我们策略回测完成时，系统会输出包含各种指标的收益曲线图，如收益概括、交易详情、每日持仓和收益、输出日志等。
![回测结果](./pictures/lianghua_sys.png)
### 收益率
Total Return: 策略整个回测时间段上的总收益率。比如，如果收益率为30%，表明起始时间是1万本金，结束时间本金变成1.3万。计算公式如下，该值越大越好。
$$
Total\ Returns = \frac{PV_{end}-PV_{start}}{PV_{start}} * 100
$$
其中，$PV_{end} = 策略最终股票和现金总价值, PV_{start} = 策略开始股票和现金总价值$。
### 年化收益率
Total Annualized Returns: 该策略每一年的收益率。比如，如果回测时间段为2年，总收益率为30%，那么每年的年化率就在15%附近（不考虑复利）。计算公式如下，该值越大越好。
$$
Total\ Annualized\ Returns = R_{p} = ((1+P)^{\frac{252}{n}}-1) * 100
$$
其中，$P=策略总收益率，n=策略执行天数$
### 基准收益率
Benchmark Returns: 策略需要有一个比较基准，比较基准为沪深300。若基准收益率为15%，表明在整个回测时间段，大盘本身就上涨了15%，如果策略收益率小于基准收益率，说明策略表现并不好，连大盘都没有跑赢。计算公式如下：
$$
Benchmark\ Returns = \frac{M_{end}-M_{start}}{M_{start}} * 100
$$
其中，$M_{end}=基准最终价值, M_{start}=基准开始价值$
### Alpha
投资中面临着系统性风险（即Beta）和非系统性风险（即Alpha），Alpha是投资者获得与市场波动无关的回报。比如投资者获得了15%的回报，其基准获得了10%的回报，那么Alpha或者价值增值的部分就是5%，计算公式如下，该值越大越好。
$$
Alpha = \alpha = R_{p}-(R_f+\beta_{p}(R_m-R_f))
$$
其中，$R_p=策略年化收益率, R_m=基准年化收益率, R_f=无风险利率(默认0.03), \beta_p=策略Beta值$

* $\alpha>0$时，策略相对于市场获得了超额收益；
* $\alpha=0$时，策略相对于市场获得了适当收益；
* $\alpha<0$时，策略相对于市场获得了较少收益；
### Beta
表示投资的系统性风险，反映了策略对大盘变化的敏感性。例如一个策略的Beta为1.5，则大盘涨1%的时候，策略可能涨1.5%，反之亦然；如果一个策略的Beta为-1.5，寿命大盘涨1%的时候，策略可能跌1.5%，反之亦然。计算公式如下，该值的绝对值越小越好。
$$
Beta=\beta_p=\frac{Cov(D_p, D_m)}{Var(D_m)}
$$
其中，$D_p=策略每日收益, D_m=基准每日收益, Cov(D_p, D_m)=策略每日收益与基准每日收益的协方差, Var(D_m)=基准每日收益的方差$

* $\beta<0$ 投资组合和基准的走向通常反方向，如空头头寸类；
* $\beta=0$ 投资组合和基准的走向没有相关性，如固定收益类；
* $0<\beta<1$ 投资组合和基准的走向相同，但是比基准的移动幅度更小；
* $\beta=1$ 投资组合和基准的走向相同，并且和基准的移动幅度贴近；
* $\beta>1$ 投资组合和基准的走向相同，但是比基准的移动幅度更大。
### 夏普比率
表示每承受一单位总风险，会产生多少的超额报酬，可以同时对策略的收益与风险进行综合考虑，也可以理解为经过风险调整后收益率。计算公式如下，该值越大越好。
$$
Sharpe\ Ratio = \frac{R_p-R_f}{\sigma_p}
$$
其中，$R_p=策略年化收益率, R_f=无风险利率(默认0.03), \sigma_p=策略年化波动率$
### 胜率
winning percentage: 衡量策略盈利指标。比如10次投资中8次获利，胜率就是80%。计算公式如下，该值越大越好。
$$
胜率 = 盈利的总次数/总交易场次*100
$$
### 盈亏比
The profit and cross ratio: 盈亏比是在投资市场里每次交易得盈利和亏损的比例。计算公式如下，该值越大越好。
$$
盈亏比 = 盈利的平均金额/亏损的平均金额
$$
### 收益波动率
收益率的标准差，用来衡量策略的风险性，波动越大代表策略风险越高。计算公式如下，该值越小越好。
$$
Volatility=\simga_p=\sqrt{\frac{252}{n}\sum_i^n(R_p-\overline{R_p})^2}
$$
其中，$R_p=策略每日收益率, \overline{R_p}=策略每日收益率的平均值=\frac{1}{n}\sum_i^nR_p, n=策略执行天数$
### 信息比率
衡量单位超额风险带来的超额收益。信息比率越大，说明该策略单位跟踪误差所获得的超额收益越高，因此，信息比率较大的策略的表现要优于信息比率较低的基准。合理的投资目标应该是在承担适度风险下，尽可能追求高信息比率。计算公式如下，该值越大越好。
$$
Information Ratio = \frac{R_p-R_m}{\theta_t}
$$
其中，$R_p=策略年化收益率，R_m=基准年化收益率，\theta_t=策略与基准每日收益差值的年化标准差$
### 最大回撤
策略在整个时间段上亏损最严重的时候相比净值最高值下跌的百分比。如果最大回撤为20%，表明策略在某个时间点上，相比之前的净值最高。
$$
Max Drawdown = \frac{Max(P_x-P_y)}{P_x}
$$
其中，$P_x,P_y=策略某日股票和现金的总价值，y>x$。
### 交易详情
交易详情主要显示了策略在整个回测过程中每个交易日的买卖信息，包括买卖时间、股票代码、交易方向、交易数量、成交价格、交易成本。具体见下图：
![](./pictures/jiaoyi_1.png)
### 每日持仓及收益
每日持仓及收益主要呈现每日持有股票代码、当日收盘价、持仓股票数量、持仓金额、收益等指标。具体见下图：
![](./pictures/jiaoyi_2.png)
### 输出日志
输出日志主要为策略运行过程中的一些日志。包括涨跌停股票不能交易、停牌估计不能交易等。该日志可以便于我们检查回测结果的正确性。